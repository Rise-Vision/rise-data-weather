<!doctype html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="../../node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
  <script src="../../node_modules/@polymer/test-fixture/test-fixture.js"></script>
  <script src="../../node_modules/mocha/mocha.js"></script>
  <script src="../../node_modules/chai/chai.js"></script>
  <script src="../../node_modules/wct-mocha/wct-mocha.js"></script>
  <script src="../../node_modules/sinon/pkg/sinon.js"></script>

</head>
<body>

<script type="text/javascript">
  RisePlayerConfiguration = {
    Logger: {}
  };
</script>

<script type="module">
  import * as loggerModule from '../../src/logger-mixin.js';

  let logger;

  setup(()=>{
    let Logger = loggerModule.LoggerMixin(class {});
    logger = new Logger();

    RisePlayerConfiguration.Logger.info = sinon.spy();
    RisePlayerConfiguration.Logger.warning = sinon.spy();
    RisePlayerConfiguration.Logger.error = sinon.spy();
  });

  teardown(()=>{
    RisePlayerConfiguration.Logger = {};
  });

  suite("logger", () => {

    suite( "init", () => {
      test( "should set element id", () => {
        logger.init("elementId");

        logger.log("info");

        assert.isTrue( RisePlayerConfiguration.Logger.info.called );
        assert.deepEqual( RisePlayerConfiguration.Logger.info.getCall(0).args[0], {
          name: "rise-data-weather",
          id: "elementId",
          version: "__VERSION__"
        });
      });
    });

    suite( "log", () => {
      test( "should call with correct parameters", () => {
        logger.log("info", "event", "details", "additionalFields");

        assert.isTrue( RisePlayerConfiguration.Logger.info.calledWith(sinon.match.object, "event", "details", "additionalFields") );
      });

      test( "should log info", () => {
        logger.log("info");

        assert.isTrue( RisePlayerConfiguration.Logger.info.called );
        assert.isFalse( RisePlayerConfiguration.Logger.warning.called );
        assert.isFalse( RisePlayerConfiguration.Logger.error.called );
      });

      test( "should log warning", () => {
        logger.log("warning");

        assert.isFalse( RisePlayerConfiguration.Logger.info.called );
        assert.isTrue( RisePlayerConfiguration.Logger.warning.called );
        assert.isFalse( RisePlayerConfiguration.Logger.error.called );
      });

      test( "should log error", () => {
        logger.log("error");

        assert.isFalse( RisePlayerConfiguration.Logger.info.called );
        assert.isFalse( RisePlayerConfiguration.Logger.warning.called );
        assert.isTrue( RisePlayerConfiguration.Logger.error.called );
      });

      test( "should not log incorrect event type", () => {
        logger.log("debug");

        assert.isFalse( RisePlayerConfiguration.Logger.info.called );
        assert.isFalse( RisePlayerConfiguration.Logger.warning.called );
        assert.isFalse( RisePlayerConfiguration.Logger.error.called );
      });

    });
  });
</script>

</body>
</html>
